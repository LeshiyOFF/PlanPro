package com.projectlibre.api.validator;

import org.springframework.stereotype.Component;

/**
 * Построитель профессиональных сообщений об ошибках календарей для пользователя.
 * Переводит технические коды ошибок в понятный человеческий язык.
 * 
 * SOLID: Single Responsibility - только формирование текстов сообщений.
 * 
 * @author ProjectLibre Team
 * @version 1.0.0
 */
@Component
public class CalendarErrorMessageBuilder {

    public String buildUserFriendlyMessage(String errorCode) {
        if (errorCode == null) return "Произошла непредвиденная ошибка при настройке календаря.";

        switch (errorCode) {
            case "SELF_REFERENCE":
            case "CIRCULAR_DEPENDENCY":
                return "⚠️ Некорректная настройка календаря\n\n" +
                       "Вы пытаетесь создать календарь, который ссылается сам на себя или образует замкнутый круг.\n\n" +
                       "Почему это нельзя сделать:\n" +
                       "Календарь работает как цепочка правил. Если он будет спрашивать правила у самого себя, " +
                       "возникнет бесконечный поиск, который приведет к сбою в расчетах всего проекта.\n\n" +
                       "Что нужно сделать:\n" +
                       "Пожалуйста, выберите в качестве 'Базового календаря' любой другой существующий календарь " +
                       "(например, 'Стандартный') или оставьте это поле пустым.";

            case "DEPTH_EXCEEDED":
                return "⚠️ Слишком сложная структура календарей\n\n" +
                       "Цепочка зависимых календарей слишком длинная (превышен лимит в 10 уровней).\n\n" +
                       "Что нужно сделать:\n" +
                       "Пожалуйста, упростите структуру, выбрав более прямой базовый календарь. " +
                       "Это необходимо для обеспечения скорости и стабильности расчетов вашего проекта.";

            default:
                return "⚠️ Внимание: Настройка календаря отклонена\n\n" +
                       "Система обнаружила потенциальную проблему в логике этого календаря, " +
                       "которая может привести к ошибкам в расписании.\n\n" +
                       "Пожалуйста, проверьте правильность выбора базового календаря.";
        }
    }
}
